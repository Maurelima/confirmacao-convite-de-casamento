/* eslint-disable @next/next/no-img-element */
import type { NextPage } from 'next'
import Head from 'next/head'
import { useCallback, useState } from 'react'
import { Col, Nav, Row, Tab, Tabs } from 'react-bootstrap'
import { api } from '../services/api'

import Swal from 'sweetalert2'

import { Container } from '../styles/home'

const Home: NextPage = () => {
  const [key, setKey] = useState<string>('geral');
  const [confirmationCode, setConfirmationCode] = useState<string>('');

  const handleConfirmation = useCallback(async () => {
    console.log('confirmado');
    if (confirmationCode && confirmationCode !== undefined) {
      try {
        const response = await api.post('/confirmation', {
          confirmationCode,
        })
        console.log(response);
        if (response.data.type === 'found') {
          Swal.fire({
            position: 'center',
            icon: 'success',
            title: 'Presen칞a confirmada!',
            text: "Obrigado por fazer parte desse t칚o momento especial. Sua presen칞a 칠 muito importante para n칩s!",
          })
        } else if (response.data.type === 'notFound') {
          Swal.fire({
            position: 'center',
            icon: 'question',
            title: 'Oops...',
            text: "N칚o encontramos seu c칩digo de confirma칞칚o... Por favor tente novamente ou entre em contato conosco (Marco ou J칰lia) para confirmar sua presen칞a.",
          })
        } else if (response.data.type === 'alreadyConfirmed') {
          Swal.fire({
            position: 'center',
            icon: 'info',
            title: 'Presen칞a j치 confirmada!',
            text: "Sua presen칞a j치 foi confirmada. Obrigado por fazer parte desse t칚o momento especial!",
            timer: 5000
          })
        } else {
          Swal.fire({
            position: 'center',
            icon: 'error',
            title: 'Oops...',
            text: "Houve um erro na confirma칞칚o! Por favor tente novamente ou entre em contato conosco (Marco ou J칰lia) para confirmar sua presen칞a.",
            timer: 5000
          })
        }
      } catch (error) {
        Swal.fire({
          position: 'center',
          icon: 'error',
          title: 'Oops...',
          text: `Houve um erro na confirma칞칚o! Por favor tente novamente ou entre em contato conosco (Marco ou J칰lia) para confirmar sua presen칞a. - [${error}]`,
          timer: 5000
        })
      }
    }
  }, [confirmationCode])

  return (
    <>
      <Head>
        <title>游눚 Casamento J칰lia e Marco 游눚</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Container>
        <header className="container-fluid">
          <img
            src="/images/nozes2.jpg"
            alt="Marco a J칰lia"
          />
          <div className="tab-menu">
            <div className="menu">
              <a onClick={() => setKey('geral')}>CONFIRMA칂츾O DE PRESEN칂A </a>
              <a onClick={() => setKey('outra')}>ENDERE칂O</a>
              <a>PRESENTEIE OS NOIVOS</a>
            </div>
            <div className="tab-bottom" />
          </div>
        </header>

        <div className="container">
          <Tabs
            id="controlled-tab-cliente"
            activeKey={key}
            onSelect={(k) => setKey(`${k}`)}
          >
            <Tab eventKey="geral" title="">
              <section>
                <div className="container">
                  <div className="row">
                    <div className="col-12">
                      <h1>CASAMENTO J칔LIA E MARCO</h1>
                    </div>
                    <div className="col-12">
                      <h3>2 de Julho de 2022</h3>
                    </div>
                    <div className="col-12">
                      <p>Para confirmar sua presen칞a informe abaixo o c칩digo recebido em seu convite</p>
                    </div>
                    <div className="col-12">
                      <form>
                        <input
                          type="text"
                          className="form-control"
                          aria-label="C칩digo de confirma칞칚o"
                          placeholder='C칩digo de confirma칞칚o'
                          onChange={(e) => setConfirmationCode(e.target.value)}
                          value={confirmationCode}
                        />
                        <button type="button" className="btn btn-primary" onClick={handleConfirmation}>
                          CONFIRMAR
                        </button>
                      </form>
                    </div>
                  </div>
                </div>
              </section>
            </Tab>
            <Tab eventKey="outra" title="">
              <section>
                <div className="container">
                  <div className="row">
                    <div className="col-12">
                      <h1>CASAMENTO J칔LIA E MARCO</h1>
                    </div>
                    <div className="col-12">
                      <h3>2 de Julho de 2022</h3>
                    </div>
                    <div className="col-12">
                      <p>Gramado, Reden칞칚o da Serra - SP (Via Rodov칤a Ot치cilio F. da Silva)</p>
                    </div>
                    <div className="col-12 d-flex justify-content-center">
                      <small>Clique no mapa para ver a localiza칞칚o completa</small>
                    </div>
                    <div className="col-12 map">
                      <a target="_blank" href="https://www.google.com.br/maps/place/Ch치cara+Fam칤lia+Lima/@-23.2959127,-45.5030806,17z/data=!4m12!1m6!3m5!1s0x94cd0f7a5d47489b:0xf68b2b6cdcb644d7!2sCh치cara+Fam칤lia+Lima!8m2!3d-23.2959127!4d-45.5008919!3m4!1s0x94cd0f7a5d47489b:0xf68b2b6cdcb644d7!8m2!3d-23.2959127!4d-45.5008919" rel="noreferrer">
                        <img src="/images/redencao.jpg" className="img-responsive" />
                      </a>
                    </div>
                  </div>
                </div>
              </section>
            </Tab>
          </Tabs>
        </div>

      </Container>
    </>
  )
}

export default Home
